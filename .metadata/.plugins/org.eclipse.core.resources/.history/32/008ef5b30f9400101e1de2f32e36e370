<%@ page import="java.util.*, model.Transaction" %>
<%@ page contentType="text/html;charset=UTF-8" %>

<html>
<head>
    <title>Transaction Report</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .btn { margin: 5px; padding: 5px 10px; }
    </style>
</head>
<body>
<h2>Transaction Report</h2>
<form method="post" action="ReportServlet">
    Account Number: <input type="text" name="accountNumber" value="<%= request.getAttribute("accountNumber") != null ? request.getAttribute("accountNumber") : "" %>"/>
    IFSC: <input type="text" name="ifscCode" value="<%= request.getAttribute("ifscCode") != null ? request.getAttribute("ifscCode") : "" %>"/>
    Status:
    <select name="status">
        <option value="">All</option>
        <option value="SUCCESS" <%= "SUCCESS".equals(request.getAttribute("status")) ? "selected" : "" %>>SUCCESS</option>
        <option value="FAILED" <%= "FAILED".equals(request.getAttribute("status")) ? "selected" : "" %>>FAILED</option>
    </select>
    Date From: <input type="date" name="dateFrom" value="<%= request.getAttribute("dateFrom") != null ? request.getAttribute("dateFrom") : "" %>"/>
    Date To: <input type="date" name="dateTo" value="<%= request.getAttribute("dateTo") != null ? request.getAttribute("dateTo") : "" %>"/>
    <input type="submit" name="submit" value="Show Report" class="btn"/>
    <a href="ExcelExportServlet?accountNumber=<%=request.getAttribute("accountNumber")%>&ifscCode=<%=request.getAttribute("ifscCode")%>&status=<%=request.getAttribute("status")%>&dateFrom=<%=request.getAttribute("dateFrom")%>&dateTo=<%=request.getAttribute("dateTo")%>" class="btn">Export Excel</a>
    <a href="PdfExportServlet?accountNumber=<%=request.getAttribute("accountNumber")%>&ifscCode=<%=request.getAttribute("ifscCode")%>&status=<%=request.getAttribute("status")%>&dateFrom=<%=request.getAttribute("dateFrom")%>&dateTo=<%=request.getAttribute("dateTo")%>" class="btn">Export PDF</a>
</form>

<%
    List<Transaction> transactions = (List<Transaction>) request.getAttribute("transactions");
    if(transactions != null && !transactions.isEmpty()) {
%>
<table>
    <tr>
        <th>ID</th><th>Account</th><th>IFSC</th><th>Bene Name</th><th>Sender</th><th>Date</th>
        <th>Amount</th><th>Currency</th><th>Mode</th><th>Status</th><th>Reference</th>
        <th>Branch</th><th>Description</th><th>Remarks</th>
    </tr>
    <%
        for(Transaction t : transactions){
    %>
    <tr>
        <td><%=t.getTransactionId()%></td>
        <td><%=t.getAccountNumber()%></td>
        <td><%=t.getIfscCode()%></td>
        <td><%=t.getBeneficiaryName()%></td>
        <td><%=t.getSenderName()%></td>
        <td><%=t.getTransactionDate()%></td>
        <td><%=t.getAmount()%></td>
        <td><%=t.getCurrency()%></td>
        <td><%=t.getMode()%></td>
        <td><%=t.getStatus()%></td>
        <td><%=t.getReferenceNumber()%></td>
        <td><%=t.getBranch()%></td>
        <td><%=t.getDescription()%></td>
        <td><%=t.getRemarks()%></td>
    </tr>
    <%
        }
    %>
</table>
<%
    } else if(transactions != null){
%>
<p>No records found.</p>
<%
    }
%>
</body>
</html>
